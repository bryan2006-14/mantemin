(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33726,e=>{"use strict";let s=(0,e.i(24632).createClient)("https://aysoiacdxglzsuhtrfnp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5c29pYWNkeGdsenN1aHRyZm5wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0NDk2MjIsImV4cCI6MjA4MDAyNTYyMn0.5agJq8Jn_o2Mdwylq7LOHO0B8TAw2jJoJwnEjOsB950");e.s(["supabase",0,s])},18566,(e,s,a)=>{s.exports=e.r(76562)},30189,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(18566),i=e.i(33726);function l(){let{id:e}=(0,t.useParams)();(0,t.useRouter)();let[l,r]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null);async function p(){let{data:s}=await i.supabase.from("ordenes").select("*, maquinas(*), usuarios(nombre), clientes(*)").eq("id",e).single();r(s)}async function m(s,a){if(!s)return;let t=`ordenes/${e}/${a}-${Date.now()}-${s.name}`,{error:l}=await i.supabase.storage.from("fotos").upload(t,s);if(l)return alert("Error upload");let{publicUrl:n}=i.supabase.storage.from("fotos").getPublicUrl(t);await i.supabase.from("fotos").insert({tarea_id:null,url:n.publicUrl,tipo:a,orden_id:e}),p()}async function x(s){await i.supabase.from("ordenes").update({estado:s}).eq("id",e),p()}return((0,a.useEffect)(()=>{p()},[]),l)?(0,s.jsxs)("div",{className:"p-6 max-w-3xl",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold",children:["OT #",l.id]}),(0,s.jsx)("p",{className:"text-gray-600",children:l.descripcion}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:"Antes"}),(0,s.jsx)("input",{type:"file",onChange:e=>c(e.target.files?.[0]||null)}),(0,s.jsx)("button",{onClick:()=>m(o,"antes"),className:"mt-2 bg-blue-600 text-white px-3 py-1 rounded",children:"Subir foto antes"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:"Después"}),(0,s.jsx)("input",{type:"file",onChange:e=>u(e.target.files?.[0]||null)}),(0,s.jsx)("button",{onClick:()=>m(d,"despues"),className:"mt-2 bg-blue-600 text-white px-3 py-1 rounded",children:"Subir foto después"})]})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("p",{className:"font-semibold",children:"Fotos"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3 mt-2",children:(0,s.jsx)(n,{ordenId:e,reload:()=>p()})})]}),(0,s.jsxs)("div",{className:"mt-6 space-x-2",children:[(0,s.jsx)("button",{onClick:()=>x("en_proceso"),className:"bg-yellow-500 px-3 py-1 rounded",children:"Marcar en proceso"}),(0,s.jsx)("button",{onClick:()=>x("finalizada"),className:"bg-green-600 px-3 py-1 rounded",children:"Marcar finalizada"})]})]}):(0,s.jsx)("div",{className:"p-6",children:"Cargando..."})}function n({ordenId:e}){let[t,l]=(0,a.useState)([]);return(0,a.useEffect)(()=>{(async()=>{let{data:s}=await i.supabase.from("fotos").select("*").eq("orden_id",e);l(s||[])})()},[e]),t.map(e=>(0,s.jsxs)("div",{className:"border rounded overflow-hidden",children:[(0,s.jsx)("img",{src:e.url,alt:e.tipo,className:"w-full h-36 object-cover"}),(0,s.jsx)("div",{className:"p-2 text-sm",children:(0,s.jsxs)("div",{children:["Tipo: ",e.tipo]})})]},e.id))}e.s(["default",()=>l])}]);