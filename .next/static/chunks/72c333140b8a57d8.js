(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80294,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(70703),l=e.i(33726);let i=(0,t.default)(()=>e.A(52169).then(e=>e.MapContainer),{loadableGenerated:{modules:[94970]},ssr:!1}),n=(0,t.default)(()=>e.A(52169).then(e=>e.TileLayer),{loadableGenerated:{modules:[94970]},ssr:!1}),o=(0,t.default)(()=>e.A(52169).then(e=>e.Marker),{loadableGenerated:{modules:[94970]},ssr:!1}),c=(0,t.default)(()=>e.A(52169).then(e=>e.Popup),{loadableGenerated:{modules:[94970]},ssr:!1});function r(){let[t,r]=(0,s.useState)([]),[u,d]=(0,s.useState)([]),[b,m]=(0,s.useState)(!1);async function p(){let{data:e}=await l.supabase.from("tecnicos").select("id, ubicacion_lat, ubicacion_lng, disponible, usuarios (nombre)").order("id"),{data:a}=await l.supabase.from("maquinas").select("id, codigo, foto_url, horometro, ubicacion_lat, ubicacion_lng");r(e||[]),d(a||[])}return((0,s.useEffect)(()=>{m(!0);{let a=e.r(32322);delete a.Icon.Default.prototype._getIconUrl,a.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"})}p();let a=l.supabase.channel("ubicaciones").on("postgres_changes",{event:"*",schema:"public",table:"tecnicos"},e=>{p()}).subscribe(),s=l.supabase.channel("maquinas").on("postgres_changes",{event:"*",schema:"public",table:"maquinas"},e=>{p()}).subscribe();return()=>{l.supabase.removeChannel(a),l.supabase.removeChannel(s)}},[]),b)?(0,a.jsx)("div",{className:"h-[620px]",children:(0,a.jsxs)(i,{center:[-12.0464,-77.0428],zoom:12,className:"h-full w-full rounded-lg shadow-lg",children:[(0,a.jsx)(n,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),t.filter(e=>e.ubicacion_lat&&e.ubicacion_lng).map(e=>(0,a.jsx)(o,{position:[e.ubicacion_lat,e.ubicacion_lng],children:(0,a.jsx)(c,{children:(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsx)("b",{className:"text-lg",children:e.usuarios?.nombre||"Técnico"}),(0,a.jsx)("br",{}),(0,a.jsxs)("span",{className:e.disponible?"text-green-600":"text-red-600",children:["Disponible: ",e.disponible?"Sí":"No"]})]})})},`tecnico-${e.id}`)),u.filter(e=>e.ubicacion_lat&&e.ubicacion_lng).map(e=>(0,a.jsx)(o,{position:[e.ubicacion_lat,e.ubicacion_lng],children:(0,a.jsx)(c,{children:(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsx)("b",{className:"text-lg",children:e.codigo}),(0,a.jsx)("br",{}),"Horómetro: ",e.horometro||"N/A"," hrs",e.foto_url&&(0,a.jsx)("img",{src:e.foto_url,alt:e.codigo,className:"mt-2 w-32 h-32 object-cover rounded"})]})})},`maquina-${e.id}`))]})}):(0,a.jsx)("div",{className:"h-[620px] flex items-center justify-center bg-gray-100 rounded-lg",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Cargando mapa..."})})}e.s(["default",()=>r])},31910,e=>{e.n(e.i(80294))},52169,e=>{e.v(a=>Promise.all(["static/chunks/983c3130c13fb657.js"].map(a=>e.l(a))).then(()=>a(94970)))}]);